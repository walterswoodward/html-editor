<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">

    <title>Easy HTML Generator</title>
    <meta name="description"
        content="Allows users to input valid HTML, and then edit attributes using an intuatively designed UI.">
    <meta name="author" content="SitePoint">
    <link href="https://fonts.googleapis.com/css?family=Nunito:400,700&display=swap" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <link rel="stylesheet" href="css/normalize.css">

</head>
<style>
    body {
        --main-bg-color: white;
        --main-color: dodgerblue;
        --main-bg-color-lighter: rgba(50, 50, 50);
        --secondary-color: rgb(89, 119, 30);
        --vertical-divider-color: gold;
        --horizontal-divider-color: gold;
        background: url('pic01.jpg');
        background-size: cover;
        font-family: 'Nunito', sans-serif;
    }

    #container {
        display: flex;
        /* margin: 0px auto; */
        width: 100%;

    }



    #imageHTMLGenerator_object_input {
        /* width: 40%; */
        height: 300px;
        text-align: start;
    }

    #nav {
        width: 100%;
        /* background: var(--main-bg-color); */
        color: var(--main-color);
        padding: 5px 0px;
        /* border-bottom: 2px dashed var(--horizontal-divider-color); */
    }

    #nav_title {
        font-size: 40px;
        padding: 20px 40px;
        font-weight: bold;
        color: var(--main-color);
    }

    #nav_title_second_half {
        color: var(--secondary-color);
        border-left: 1px solid darkgray;
        padding-left: 10px;
    }

    #copyToClipboardButton {
        width: 200px;
        height: 50px;
        font-size: 20px;
        font-weight: bold;
        color: var(--main-color);
        background: var(--main-bg-color);
        /* border: 5px dashed white; */
        /* margin: 10px; */
        transition: background 0.5s;
        transition: color 0.5s;
        transition: 'border-color'0.5s;
        transition: cursor 0.1s;
        /* -webkit-box-shadow: 7px 7px 7px -5px white;
        box-shadow: 7px 7px 7px -5px white; */
        border-style: outset;
        border-top: 4px solid var(--main-bg-color);
        border-bottom: 4px solid var(--main-bg-color-lighter);
        border-left: 4px solid var(--main-bg-color);
        border-right: 4px solid var(--main-bg-color-lighter);
        border-radius: 4px;

    }

    .button_styles {
        width: 200px;
        height: 50px;
        font-size: 20px;
        font-weight: bold;
        color: palevioletred;
        background: var(--main-bg-color);
        transition: background 0.5s;
        transition: color 0.5s;
        transition: 'border-color'0.5s;
        transition: cursor 0.1s;
        border-style: outset;
        border-top: 4px solid var(--main-bg-color);
        border-bottom: 4px solid var(--main-bg-color-lighter);
        border-left: 4px solid var(--main-bg-color);
        border-right: 4px solid var(--main-bg-color-lighter);
        border-radius: 4px;
    }

    .button_styles:hover {
        cursor: pointer;
    }

    button:focus,
    textarea:focus {
        outline: 0;
    }

    .button_styles:focus {
        outline: 0;
    }

    .button_styles:active {
        color: yellowgreen;
        border-color: yellowgreen;
        border-top: 4px solid var(--main-bg-color-lighter);
        border-bottom: 4px solid var(--main-bg-color);
        border-left: 4px solid var(--main-bg-color-lighter);
        border-right: 4px solid var(--main-bg-color);
    }

    #copyToClipboardButton:hover {
        cursor: pointer;
    }

    #copyToClipboardButton:active {
        color: yellowgreen;
        border-color: yellowgreen;
        border-top: 4px solid var(--main-bg-color-lighter);
        border-bottom: 4px solid var(--main-bg-color);
        border-left: 4px solid var(--main-bg-color-lighter);
        border-right: 4px solid var(--main-bg-color);
    }

    #copyToClipboardButton:focus {
        outline: 0;
    }



    #generateImageHTML_button:hover {
        cursor: pointer;

    }

    #left_panel {
        display: flex;
        flex-direction: column;
        /* align-items: center; */
        width: 50%;
        /* border-right: 2px dashed var(--vertical-divider-color); */
        z-index: 2;
        /* background-color: var(--main-bg-color); */
        color: var(--secondary-color);


    }

    #left_panel_instructions {
        font-size: 20px;
        padding: 20px;
        font-weight: bold;
        /* background: black; */
        margin-bottom: 10px;
        /* border: 2px dashed var(--secondary-color); */
    }

    #user_html_input {
        display: flex;
        margin: 0px 3% 10px 3%;
        width: 90%;
        height: 100px;
        padding: 2%;
    }

    #right_panel {
        background: rgba(0, 0, 0, 0.9);
        z-index: 1;
        width: 50%;
        display: flex;
        flex-direction: column;
        align-content: center;
        align-items: center;
        /* background-color: var(--main-bg-color); */
        color: var(--main-color);
        height: 100vh;
        overflow: hidden;
    }

    #right_panel_title {
        font-size: 25px;
        font-weight: bold;
        padding: 20px;
    }

    #output_html {
        /* display: flex; */
        /* flex-direction: column;
        align-items: center; */
        padding: 15px;
        font-size: 16px;
        z-index: 0;
    }

    #input_fields {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-around;
    }



    .inputs_container {
        display: flex;
        flex-direction: column;
        padding: 5px 10px;
        align-items: flex-start;
        font-weight: bold;
        font-size: 18px;
        color: var(--main-color);
    }

    .inputs_container_title {
        font-size: 20px;
        font-weight: normal;
    }

    /* .inputs_container_item {
        padding: 10px 0px;
        font-size: 14px;
        display: flex;
        flex-direction: column;
        font-weight: normal;
    } */

    .input_item_label {
        display: flex;
        flex-direction: column;
        font-size: 14px;
        color: var(--secondary-color);
        font-weight: normal;
    }

    label {
        margin-bottom: 5px;
    }

    input {
        width: 200px;
        padding: 2px;
        -webkit-box-shadow:
            inset 0 0 8px rgba(0, 0, 0, 0.1),
            0 0 16px rgba(0, 0, 0, 0.1);
        -moz-box-shadow:
            inset 0 0 8px rgba(0, 0, 0, 0.1),
            0 0 16px rgba(0, 0, 0, 0.1);
        box-shadow:
            inset 0 0 8px rgba(0, 0, 0, 0.1),
            0 0 16px rgba(0, 0, 0, 0.1);
        padding: 5px;
        background: rgba(255, 255, 255, 0.5);
        border-radius: 5px;
    }



    #next_button_container {
        display: flex;
        padding-left: 25px;
    }

    #next_button {
        width: 100px;
        height: 40px;
        align-self: center;
    }

    #next_button_count {
        padding: 10px 0px 0px 10px;
    }

    #warning_message {
        color: darkgoldenrod;
        padding: 10px 0px 0px 10px;
    }

    #final_output_html {
        position: absolute;
        z-index: -1;
        top: -1000px;
    }

    .hide_button {
        background: transparent;
        border: none;
        font-weight: bold;
        font-size: 14px;
    }

    .hide_button:hover {
        color: yellowgreen;
        cursor: pointer;
    }

    xmp {
        white-space: pre-wrap;
        /* Since CSS 2.1 */
        white-space: -moz-pre-wrap;
        /* Mozilla, since 1999 */
        white-space: -pre-wrap;
        /* Opera 4-6 */
        white-space: -o-pre-wrap;
        /* Opera 7 */
        word-wrap: break-word;
    }

    @media(max-width: 1200px) {
        #container {
            display: flex;
            flex-direction: column;
        }

        #left_panel {
            width: 100%;
            border: none;
        }

        #right_panel {
            margin-top: 10px;
            width: 100%;
            border: none;
            /* border-top: 2px dashed var(--vertical-divider-color); */
        }


    }
</style>

<body>
    <!-- {
                    div_class: 'col-md-2 col-sm-3 col-xsm-6',
                    div_style: 'text-align: center; padding: 20px',
                    a_class: 'woocommerce-main-image zoom',
                    a[href]: '/wp-content/uploads/2018/08/small-quad.jpg',
                    a_data-title: 'img title',
                    a[data-lightbox-gallery]: 'rearliftgal',
                    img_class: 'attachment-shop-thumb-main size-shop-thumb-main wp-post-image',
                    img_style: 'border: 2px solid #cfcfcf;',
                    img_title: 'Walkin' Wheels Full Support/4-Wheel SMALL',
                    img_src: '/wp-content/uploads/2018/08/small-quad-150x150.jpg',
                    img_alt: 'Walkin' Wheels Full Support/4-Wheel SMALL',
                    img_width: '150',
                    img_height: '150'
                } -->
    <div id="nav">
        <div id='nav_title'>Custom Tabs <span id="nav_title_second_half">Image HTML Generator</span></div>
    </div>
    <div id="container">
        <div id="left_panel">

            <div id="left_panel_instructions">Welcome to the Custom Tabs Image HTML Generator.
                Below, please paste some valid HTML you wish to edit. This panel includes a
                dynamically generated list of all the attributes found in any valid html
                submitted below. Please alter the attributes using the form below. When you are finished,
                click 'Copy to Clipboard' to copy the generated HTML.</div>

            <textarea id="user_html_input" oninput="handleUserInputtedHTML();" val=""></textarea>
            <!-- <button onclick="validateUserHTMLInput();">Validate</button> -->
            <!-- <input type=text id="user_html_input"> -->

            <div id="input_fields">
                <!-- <button id="copyToClipboardButton" onclick="copyToClipBoard();">Copy To Clipboard</button> -->
            </div>
            <div id="next_button_container">
                <button id="next_button" class="button_styles">Next</button><span id="next_button_count"></span><span
                    id="warning_message"></span>
            </div>

        </div>
        <div id="right_panel">
            <div id="right_panel_title">Generated HTML Preview</div>
            <xmp id="output_html">

            </xmp>
            <input type="text" id="final_output_html"></input>
            <button id="copyToClipboardButton" onclick="copyToClipBoard();">Copy To Clipboard</button>
        </div>
    </div>
    <script src="libs/indent.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/html-inspector/0.8.2/html-inspector.js"></script>
    <script>

        let trimmed = "empty";

        function imageHTMLGenerator(element) {
            // console.log('Element:', $(element)[0].id);
            // console.log('Element\'s Grandparent: ', $(element).parent().parent()[0].id);
            // console.log('This is #user_html_input: ', $('#user_html_input').val());
            let grandpaId = $(element).parent().parent()[0].id;
            let elId = $(element)[0].id;

            var tin = document.createElement('span');
            tin.innerHTML = $('#user_html_input').val();
            // console.log('This is the element: ', $(grandpaId, tin));
            // console.log('By tag name ', tin.getElementsByTagName(grandpaId));
            let elementToEdit = tin.getElementsByTagName(grandpaId);
            $(elementToEdit).attr(elId, $(element).val());

            // console.log('Edited?:', elementToEdit);
            var indented = indent.html(tin.innerHTML, { tabString: '\t' });
            // console.log('This is indented: ', indented);

            $('#output_html').text(indented); // TODO - Pu

            // console.log('This is current input grandparent: ', tin.getElementById($(element)[0].id));


            // output_object[id] = $("#" + id).val();
            // // console.log(output_object[id])


            // Render to Screen
            // $('#output_html').html(generatedHTML);
            // Print to Input (where copyToClipboard grabs it from)
            console.log('From first: ', $('#output_html').text())
            trimmed = (tin.innerHTML).replace(/\n/g, "").replace(/\t/g, "").replace(/\s+/g, " ").replace(/(\r\n|\n|\r)/gm, " ");
            // $("#final_output_html").html(tin.innerHTML);
            console.log('trimmed ', trimmed);
        }

        function handleUserInputtedHTML() {
            // Clear Input Fields
            $('#input_fields').html('');
            nextButtonCount = 0;


            // Print to Input (where copyToClipboard grabs it from)
            trimmed = ($('#user_html_input').val()).replace(/\n/g, "").replace(/\t/g, "").replace(/\s+/g, " ").replace(/(\r\n|\n|\r)/gm, " ");


            // Render User Inputted HTML to Preview Screen
            $('#output_html').html(trimmed);
            $("#final_output_html").val(trimmed);
            $('#user_html_input').val(trimmed);
            console.log('This is trimmed: ', trimmed);


            // ==== Generate Inputs Form Based on Attributes found in User's HTML ==== /
            var el = document.createElement('span');
            el.innerHTML = trimmed;
            // console.log('This is the element: ', el)



            let inputFieldsElement = document.getElementById('input_fields');



            let inputFieldsTags = $('*', el);



            inputFieldsTags.each(function (index, item) {
                inputsContainerElement = document.createElement('DIV');
                inputsContainerElement.setAttribute('id', $(item)[0].localName)
                inputsContainerElement.className = "inputs_container"
                // console.log(index, ": ", $(item))

                inputsContainerTextNode = document.createTextNode($(item)[0].localName);
                inputsContainerElement.appendChild(inputsContainerTextNode);

                inputFieldsElement.appendChild(inputsContainerElement);

                Object.keys($(item)[0].attributes).forEach(function (key, value) {
                    // console.log($(item)[0].attributes[key])
                    console.log('$(item)[0].attributes[key]:', $($(item)[0].attributes[key])[0].name);
                    let attrName = $($(item)[0].attributes[key])[0].name;
                    labelItemElement = document.createElement('LABEL');
                    labelItemElement.setAttribute('id', attrName + "_label")
                    labelItemElement.setAttribute('text', attrName);
                    labelItemElement.className = "input_item_label";

                    // Add Edit Button to Label
                    labelEditButton = document.createElement('BUTTON');
                    labelEditButton.setAttribute('onclick', "hideItem(this);");
                    labelEditButton.className = "hide_button";

                    // Text Content for Edit Button
                    buttonTextNode = document.createTextNode('hide');
                    labelEditButton.appendChild(buttonTextNode);

                    // Append button to Label
                    labelItemElement.appendChild(labelEditButton);

                    // Add Text Content to Label
                    labelTextNode = document.createTextNode(attrName);
                    labelItemElement.appendChild(labelTextNode);

                    // Create Input
                    inputsItemElement = document.createElement('INPUT');
                    // Input type = 'text';
                    inputsItemElement.type = 'text';
                    inputsItemElement.setAttribute('id', attrName);
                    inputsItemElement.setAttribute('oninput', 'imageHTMLGenerator(this);')
                    labelItemElement.appendChild(inputsItemElement);
                    inputsContainerElement.appendChild(labelItemElement);


                })
            })


            $('#input_fields .hide_button').each(function (index, item) {
                $(item).click();
            })

            if (!inputFieldsTags.length) {
                $('#output_html').text('No valid HTML found! Please try again!');
            }
        }

        function copyToClipBoard() {
            var copyText = document.getElementById("final_output_html");
            copyText.select();
            copyText.setSelectionRange(0, 99999)
            document.execCommand("copy");
            // console.log("Copied the text: " + copyText.value);
        }

        function getRandomColor() {
            var letters = '0123456789ABCDEF';
            var color = '#';
            for (var i = 0; i < 6; i++) {
                color += letters[Math.floor(Math.random() * 16)];
            }
            return color;
        }

        let combinedImages = '';

        let nextButtonCount = 0;
        $('#next_button').on('click', function () {
            // Append new html to master string - combinedImages
            if (trimmed !== "empty") {
                combinedImages = combinedImages + trimmed;
                // Post a preview of the output in the console
                console.log('%c ' + combinedImages, 'background: #222; color: ' + getRandomColor());
                // alert('Image saved! Preview output html in console')

                $("#final_output_html").val(combinedImages);
            }





            let message = nextButtonCount + ' Copies Appended';

            if (trimmed === 'empty') {
                $('#warning_message').text(' Warning: EMPTY element found, nothing appended');
                setTimeout(() => {
                    $('#warning_message').text('');
                }, 3000);

            }

            $('#next_button_count').text(message);

            // Clear Previous values
            $('#input_fields input').each(function (index, item) {
                $(item).val('')
            })
            if (trimmed !== 'empty') {
                // Increment Next Button Count
                nextButtonCount++
            }

        })

        function hideItem(element) {
            // console.log('Inside hideItem: ', element);
            if ($(element).next().is(':hidden')) {
                $(element).next().show();
                $(element).text('hide');
                $(element).parent().css("padding", "10px 0px");
            } else {
                $(element).next().hide();
                $(element).text('edit');
                $(element).parent().css("padding", "0px 0px");
            }


        }

        // Not that useful: -- Need a validator that checks to make sure all tags line up
        // function validateUserHTMLInput() { 
        //     console.log('Inside validateUserHTML');
        //     HTMLInspector.inspect("#output_html")
        // }


    </script>
</body>

</html>